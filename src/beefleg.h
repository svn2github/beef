#ifndef beefleg_h
#define beefleg_h 1

#define nsamples 2000

#define nmax 30

extern void dgemv_(const char *, const int *, const int *, const double *,
    double *, const int *, double *, const int *, const double *, double *,
    const int *);

extern double ddot_(const int *, double *, const int *, double *, const int *);

//beef exchange enhancement factor legendre polynomial coefficients
static double mi[] = {
 1.516501714304992365356,
 0.441353209874497942611,
-0.091821352411060291887,
-0.023527543314744041314,
 0.034188284548603550816,
 0.002411870075717384172,
-0.014163813515916020766,
 0.000697589558149178113,
 0.009859205136982565273,
-0.006737855050935187551,
-0.001573330824338589097,
 0.005036146253345903309,
-0.002569472452841069059,
-0.000987495397608761146,
 0.002033722894696920677,
-0.000801871884834044583,
-0.000668807872347525591,
 0.001030936331268264214,
-0.000367383865990214423,
-0.000421363539352619543,
 0.000576160799160517858,
-0.000083465037349510408,
-0.000445844758523195788,
 0.000460129009232047457,
-0.000005231775398304339,
-0.000423957047149510404,
 0.000375019067938866537,
 0.000021149381251344578,
-0.000190491156503997170,
 0.000073843624209823442
};

//LDA & PBE correlation fractions used in beef-vdw xc
#define beefldacfrac 0.600166476948828631066
#define beefpbecfrac (1.-beefldacfrac)


// beefmat * v = beefcoeff
// v: random (normal distr.) vector of length nmax+1
static double beefmat[] = {
 -2.789371148003274e-01,
 -8.658072452419485e-02,
 -5.585590792088605e-02,
 -3.370500505864544e-02,
 -4.399174203967363e-02,
 -2.450349185561366e-02,
 -1.327619391439740e-02,
 -1.050998172699695e-02,
 -4.273663487827185e-04,
 -4.936495679753976e-04,
 1.613432711986972e-05,
 -3.404192556599938e-04,
 -4.219473976222909e-04,
 -3.997758493499628e-04,
 -1.152277055619719e-04,
 5.251845033263636e-04,
 6.811717331971846e-04,
 -2.049869921588730e-04,
 -4.070971800165947e-04,
 3.139775637308954e-04,
 6.028054428567003e-05,
 3.369066394426938e-05,
 -8.738510044617147e-05,
 1.554502701498733e-04,
 2.735009167855798e-04,
 -2.947711026670768e-04,
 -5.511186434878633e-04,
 -1.984582734436600e-06,
 -5.554634699346558e-07,
 -9.863836025780384e-10,
 -1.575715931197517e-09,
 -5.620838318506893e-01,
 2.237950398674131e-02,
 -5.018867485806575e-02,
 -1.030273854244432e-02,
 3.084248240271389e-03,
 7.939882494974593e-03,
 1.055599818751881e-02,
 1.391642774613195e-02,
 -1.729803450276382e-03,
 -5.816977052760651e-04,
 -4.936492928212488e-04,
 4.429094912103310e-04,
 3.919812131898209e-04,
 3.653462262558475e-04,
 4.711411497501145e-04,
 2.462425197080557e-04,
 -1.707307185971649e-04,
 -2.013987751447654e-04,
 1.342379191146043e-03,
 -9.945212843070390e-04,
 -2.806685090081659e-04,
 -2.532102731900885e-04,
 1.419144955930046e-04,
 -2.521297101365606e-04,
 -4.347468475449380e-04,
 4.663955873709189e-04,
 8.640719724374699e-04,
 2.661358188611453e-06,
 5.945926545769510e-07,
 1.898777238992940e-09,
 2.166761483578919e-09,
 -4.188982559506005e-01,
 8.530944001268455e-02,
 8.208921425757648e-02,
 2.107745451436756e-02,
 2.453206523984576e-02,
 7.459329902275340e-03,
 -8.751716427957805e-04,
 -7.526534007440514e-03,
 2.542267704027132e-03,
 1.925811306204660e-03,
 1.427729903803190e-03,
 -1.163240070129587e-03,
 -7.790578458215181e-04,
 -7.192387562252331e-04,
 -1.143483316974353e-03,
 -1.210958943212128e-03,
 -3.737182769467835e-04,
 6.710074274698681e-04,
 -2.011448762627631e-03,
 1.354946010409216e-03,
 3.936215710072629e-04,
 3.736780613869630e-04,
 -1.899873019451018e-04,
 3.181221982092014e-04,
 5.123306984135878e-04,
 -5.451917522418934e-04,
 -1.007633849432936e-03,
 -2.664416230155660e-06,
 -5.542501226451487e-07,
 -1.085471750406723e-08,
 -2.081149141035285e-09,
 -7.807009602721225e-02,
 1.577980930944776e-03,
 1.654755698541458e-01,
 -1.328420202717257e-02,
 -4.842565156822068e-03,
 -1.582021704691475e-02,
 -8.391178854885136e-03,
 -9.870834152603819e-03,
 -1.975556075460546e-03,
 -1.441263404363387e-03,
 -2.572682662067533e-03,
 1.577427828587720e-03,
 1.604060521562633e-03,
 9.979787580628053e-04,
 1.626659681256558e-03,
 1.322274400111160e-03,
 5.597732851891278e-04,
 -6.776295988534164e-04,
 1.605218564055816e-03,
 -7.906600634562681e-04,
 -2.739813003030365e-04,
 -1.470172722007440e-04,
 1.842387458762127e-04,
 -3.244428988852842e-04,
 -4.289262385647389e-04,
 4.619313546025519e-04,
 8.404492735701972e-04,
 2.561543845197094e-06,
 -5.131462428089725e-07,
 3.463339154332864e-09,
 -2.878539163981424e-08,
 7.424108755278949e-02,
 -5.428004012043981e-03,
 6.553441283328150e-02,
 -7.367678988459664e-02,
 4.912606659632013e-04,
 -6.374184717061445e-03,
 1.802292036286199e-02,
 1.814743842091288e-02,
 -5.128151886103606e-03,
 1.564332978552515e-03,
 3.767433494036893e-05,
 -1.916146075159663e-03,
 -5.130300239960812e-04,
 -1.173749509527296e-03,
 -2.742483186094752e-04,
 -2.892944049149743e-04,
 1.364393083224059e-04,
 3.845105849963825e-04,
 1.644649356951611e-04,
 -2.819810171741512e-04,
 -2.683625843068057e-04,
 -3.624500488929011e-04,
 -2.703885380675189e-04,
 2.682478556511751e-04,
 3.459671754875762e-04,
 -3.347658429244980e-04,
 -6.270793965008824e-04,
 1.630334906742374e-06,
 -5.324397339250975e-07,
 -1.196134831668932e-07,
 -9.889738487939110e-10,
 1.921953979064029e-02,
 -2.020676413828818e-04,
 -5.196972688621750e-02,
 -5.132766959149202e-02,
 3.720713144783828e-02,
 -9.186437624094667e-03,
 4.052158800974907e-03,
 -1.970874052421905e-02,
 1.552825705260402e-04,
 5.527231417394828e-03,
 -3.606510778661092e-04,
 -2.292120957847533e-03,
 6.049311993717353e-04,
 -1.326401083006902e-03,
 -1.192515467100129e-03,
 -2.536710849612489e-03,
 -2.047146674737054e-04,
 1.008461509117919e-03,
 -2.026987015852654e-03,
 1.814234322406732e-03,
 3.191662448620388e-04,
 1.089932311372856e-03,
 1.597719418976073e-04,
 -3.699398269798067e-04,
 -2.809542988923003e-04,
 3.367341200821313e-04,
 5.301625656678995e-04,
 2.260364190587812e-06,
 -6.016237606058214e-06,
 2.708087584478510e-10,
 -2.062627130771649e-07,
 -1.993251360021418e-02,
 -3.159013902514446e-03,
 -4.129092678192872e-02,
 2.293088777139022e-02,
 2.858848071817625e-02,
 -2.542253880793507e-02,
 7.429165126753713e-03,
 -5.644174379606062e-03,
 -9.658304744145457e-03,
 2.432430868483337e-03,
 -5.306314035773463e-03,
 -6.132750262358568e-04,
 3.330116845173789e-03,
 1.816648980554334e-04,
 4.280508272875135e-03,
 2.723527645750429e-03,
 1.267112674402933e-03,
 -3.308589701926816e-04,
 3.798854072546985e-03,
 -1.999766240081196e-03,
 -1.234998180922590e-03,
 -1.346241811410619e-03,
 -5.343780943645562e-04,
 2.410306548765760e-04,
 3.481300514366072e-04,
 -2.324334377868888e-04,
 -4.515987404079185e-04,
 1.511907454780171e-05,
 -6.901102517661473e-07,
 -5.384276263144980e-07,
 -2.333027383295469e-09,
 4.301179866976423e-04,
 9.955278506653953e-04,
 1.636794347760120e-02,
 4.278505054376050e-02,
 -2.045256893008401e-02,
 -1.922708440465171e-02,
 1.437313072475651e-02,
 5.727635741448499e-03,
 -1.275830745216743e-02,
 3.211272975637869e-03,
 -5.499119767602525e-03,
 -3.229604734269898e-03,
 2.128654646550313e-03,
 -2.947653606676976e-03,
 -1.020155984474381e-03,
 -3.295485484992980e-03,
 1.181313973419951e-03,
 1.417436526866075e-03,
 -2.565899923013535e-03,
 2.952673245520007e-03,
 9.700493849353153e-05,
 1.743727188187680e-03,
 5.975456513449454e-05,
 -6.003611660096218e-04,
 -1.323063153939130e-04,
 2.602815319523262e-04,
 1.667791115231270e-04,
 1.388420131379808e-06,
 -2.253074233037992e-05,
 -5.827332326097059e-10,
 -7.380512785551196e-07,
 4.929090677222425e-03,
 3.061086993229277e-03,
 1.431379614657705e-02,
 4.818176915744634e-04,
 -2.598297748785821e-02,
 2.434837876966976e-02,
 9.051001054515118e-03,
 -1.351652896737639e-02,
 1.872609882720758e-03,
 1.239055744612657e-02,
 9.122702568300817e-04,
 -7.036446577650850e-03,
 1.408812505300581e-03,
 -3.406745499265649e-03,
 1.260378456076090e-03,
 -2.181238586928384e-03,
 -2.108432446662707e-05,
 2.269892490217839e-03,
 2.222619110417995e-03,
 -1.333927857152772e-03,
 -1.820495601294457e-03,
 -1.344679186385411e-03,
 -9.990975966818988e-04,
 2.343510245079157e-04,
 2.525414130744434e-04,
 1.113448463065590e-04,
 1.528684286544836e-04,
 4.777017681031597e-05,
 -3.057057416282199e-09,
 -1.593260709278137e-06,
 1.828042105429800e-09,
 -2.811022771726025e-03,
 -3.123146724270331e-03,
 -7.595116329636269e-03,
 -2.126018196277443e-02,
 1.499060043181123e-03,
 2.694808516011417e-02,
 -1.312599374451519e-02,
 2.532809587594022e-03,
 -5.135031258498327e-03,
 -1.614311509822562e-03,
 -8.128734693669475e-03,
 3.605917402676041e-04,
 5.650250844483372e-03,
 -6.677925233172530e-04,
 5.032666255460955e-03,
 1.808821319525783e-03,
 3.743104557120908e-03,
 -8.344801497608005e-05,
 9.861438050540975e-04,
 2.640100955388348e-03,
 -5.934141929116134e-04,
 2.073968682898131e-03,
 -5.979763433307510e-05,
 -1.087208777593729e-03,
 8.096721378040244e-05,
 1.737327907575347e-04,
 -3.985070037892538e-04,
 4.733497080631047e-07,
 -5.598517394658997e-05,
 3.402779238736331e-09,
 -1.903186390103096e-06,
 -3.128035958847397e-04,
 5.030048694316011e-04,
 -2.868339913502047e-03,
 -1.200827786699008e-03,
 1.409983493424906e-02,
 -9.534666039028484e-03,
 -2.374058116639258e-02,
 1.318845534468765e-02,
 1.446054817774862e-03,
 -4.203754578271998e-03,
 -1.467001316938540e-03,
 -1.967133776789107e-03,
 1.302508432953019e-03,
 -3.155021775435083e-03,
 -8.623362896875300e-04,
 -5.063405066641709e-03,
 -6.884064155337214e-04,
 3.864312106302323e-03,
 -2.753258591253884e-04,
 2.100286007429097e-04,
 -2.235993993465956e-03,
 -1.384065225454317e-03,
 -1.676360566700586e-03,
 3.709866230538747e-04,
 5.028426414841345e-04,
 2.134282568330382e-04,
 2.936101555985913e-04,
 1.031234746405975e-04,
 2.398707139211300e-07,
 -3.671051043071066e-06,
 2.932465423321634e-09,
 1.336812138015427e-03,
 1.487736501350680e-03,
 4.233727868726825e-03,
 8.953229749998447e-03,
 3.236741993885101e-03,
 -1.650984261650615e-02,
 4.266238817552344e-03,
 5.128752068767695e-03,
 1.931876528183836e-02,
 1.284040109895158e-03,
 8.904197308119513e-03,
 -2.580552681642640e-03,
 -1.942655439652693e-03,
 -2.138300271813744e-03,
 1.119852204318188e-03,
 4.586046723007044e-04,
 3.021321607769513e-03,
 -4.380336652271193e-05,
 2.895502091021778e-03,
 7.618851014885638e-04,
 -1.440665548835050e-03,
 1.991316026741569e-03,
 -1.957445492136847e-04,
 -1.620627857991368e-03,
 -4.239741630027565e-05,
 5.266895540195072e-04,
 -3.147370607468860e-04,
 1.130585476484031e-06,
 -1.102578041948821e-04,
 7.444874222467801e-10,
 -4.023147547855773e-06,
 -5.754280653645700e-04,
 -1.396204767691126e-03,
 -7.791073314969609e-04,
 -2.029344539682297e-03,
 -8.058427711344436e-03,
 9.256180270837654e-04,
 1.836514186408228e-02,
 -8.085520817666733e-03,
 5.956747371760051e-03,
 -1.081337300969461e-02,
 5.364897100004743e-04,
 8.048356965776955e-03,
 1.178690719517912e-03,
 3.458592143827839e-03,
 2.804825203371477e-03,
 1.329806234029041e-03,
 -1.217409362956156e-04,
 1.850954909698949e-03,
 -1.772658069374947e-03,
 2.461780742580759e-03,
 -1.332754285825187e-03,
 -4.294637558995286e-04,
 -1.957448795384547e-03,
 3.063160918452921e-04,
 8.708297692021085e-04,
 2.210793930190644e-04,
 2.500238269016123e-04,
 1.856731949187149e-04,
 1.095004204517119e-06,
 -7.214686014840088e-06,
 1.426098597466234e-09,
 -2.660458892634171e-04,
 1.193075238014117e-04,
 -1.590404968405682e-03,
 -2.546482865912339e-03,
 2.456249244820341e-04,
 8.213727333199979e-03,
 7.237212228191809e-04,
 -8.030578258685896e-03,
 -1.646189173570139e-02,
 -7.472640408793089e-03,
 3.330899999436509e-03,
 3.860557857173728e-03,
 -5.193901826318760e-03,
 7.478359498458297e-04,
 -4.732984625935717e-03,
 -2.557643401300554e-03,
 -1.318409416278675e-03,
 2.229624179294475e-04,
 2.146137521624227e-03,
 -1.706481586965839e-03,
 -1.679305792381372e-03,
 5.996695038017679e-04,
 -4.259693464477034e-04,
 -1.626279737618154e-03,
 5.574873506417436e-06,
 7.130176268267931e-04,
 -5.417089493000330e-04,
 4.092697125198031e-07,
 -1.861572123285825e-04,
 -8.840214206727060e-10,
 -7.464463902101032e-06,
 3.135719028739218e-04,
 7.959786690784733e-04,
 1.224237448431571e-03,
 2.243298392464390e-03,
 3.736039263143552e-03,
 -1.834631542284356e-04,
 -8.944798623583322e-03,
 5.117000377355501e-03,
 -9.861294365175525e-03,
 1.298245037521622e-02,
 5.956853902560579e-03,
 -8.829357249973744e-04,
 -5.235585310895704e-03,
 2.514077737280561e-03,
 -9.471880614784641e-04,
 4.849846971057417e-03,
 1.145590206763454e-03,
 -2.527826303686120e-03,
 -8.751855795770104e-04,
 1.498894683709046e-03,
 1.658746110864812e-04,
 5.301014658165526e-04,
 -1.476959831130855e-03,
 1.409929015374331e-04,
 1.021037710514797e-03,
 3.465215293075707e-04,
 4.289478272163921e-04,
 2.882716026215851e-04,
 1.960557511860241e-06,
 -1.268695948124986e-05,
 2.686994195465261e-09,
 6.211869004531519e-05,
 -6.926658115099590e-04,
 6.511434760664787e-05,
 -4.629951584234232e-04,
 -2.634125345107356e-03,
 -4.114504417775870e-03,
 -1.311901439646290e-03,
 4.351757128741578e-03,
 9.062951746900487e-03,
 1.087661720768896e-02,
 -9.507416771049585e-03,
 2.568113928518649e-03,
 2.520972720973731e-03,
 4.964521335788302e-03,
 -5.081505881479845e-04,
 9.071743045427604e-04,
 -4.899005276575926e-03,
 3.504217727545214e-04,
 -2.237623778021182e-03,
 -1.356037161395229e-03,
 3.827981435797183e-05,
 -6.592163098305833e-04,
 -3.211976867176137e-04,
 -1.111187907449082e-03,
 -4.417645380248470e-05,
 8.889069039748088e-04,
 -5.304315542075854e-04,
 1.697100024732217e-06,
 -2.746967129087126e-04,
 -9.068388206383231e-10,
 -1.258057527386433e-05,
 -2.135967413997328e-04,
 -4.001816994592548e-05,
 -5.775057602607727e-04,
 -6.418071134373202e-04,
 2.030293049034727e-04,
 1.635111934194612e-03,
 3.985702219180915e-03,
 -2.709568082484072e-03,
 7.217536304851976e-03,
 -7.816370814765649e-03,
 -1.017336576710991e-02,
 -6.135934427903662e-03,
 6.954936645062333e-04,
 -2.636388339338739e-03,
 -4.518177157711499e-03,
 -7.778555802517690e-04,
 4.349621745442441e-05,
 -4.192233914971323e-03,
 1.407423742495086e-03,
 -1.565952074085649e-03,
 1.670384490390182e-03,
 9.543873662209251e-04,
 -1.617307404854256e-04,
 3.947887421958462e-05,
 1.103955645780035e-03,
 1.966402192200054e-04,
 1.636358960098758e-04,
 3.916396076126565e-04,
 2.344766226674296e-06,
 -2.050208724454956e-05,
 1.433307414240862e-09,
 2.215762044039487e-06,
 6.675003294175188e-04,
 2.917297103374639e-04,
 7.902070394024956e-04,
 1.558717827970864e-03,
 1.162015177559003e-03,
 6.224023646309785e-05,
 -1.381136743006516e-03,
 -4.374840359812311e-03,
 -8.610122733665987e-03,
 7.431044807758061e-03,
 -8.902109304634469e-03,
 3.027407221541975e-03,
 -3.166013263063505e-03,
 3.147736899325532e-03,
 2.959755978208330e-03,
 2.115509611018787e-04,
 -7.709101529396020e-04,
 -3.307290208784295e-03,
 -4.621060886398054e-04,
 1.606120935544640e-03,
 -2.018741841350897e-03,
 -6.487686079625239e-06,
 1.652215307145485e-04,
 -1.672629626719618e-04,
 9.243120832165063e-04,
 -2.228758314807679e-04,
 2.551143108855626e-06,
 -3.603997088184914e-04,
 -3.745719241771409e-09,
 -1.968823597953806e-05,
 2.580762094581199e-04,
 -7.224454432443367e-04,
 1.079036812741475e-04,
 -4.176023894818417e-04,
 -1.744826961226812e-03,
 -1.801671061376039e-03,
 -1.585933558674895e-03,
 1.417547310672021e-03,
 -3.355627140411811e-03,
 3.565214744423706e-03,
 8.814839946907656e-03,
 6.378180465988480e-03,
 6.848168104836854e-03,
 -1.027654673035261e-03,
 3.561285130383335e-03,
 -3.891980880068621e-03,
 -1.998089722381538e-03,
 1.212839551387236e-03,
 5.825986529721192e-04,
 -1.885090976692521e-03,
 2.020025845228696e-03,
 1.065931826440052e-03,
 1.614629052753342e-03,
 -2.567827478818822e-04,
 6.860835077263450e-04,
 4.467463955476736e-05,
 -2.373871262114544e-05,
 4.690956519607273e-04,
 3.275098512693885e-06,
 -3.099595508612330e-05,
 1.050887784748338e-09,
 -2.609029587307337e-04,
 2.259315706898537e-04,
 -2.587334035415293e-04,
 -1.043203406900263e-04,
 5.339623060215102e-04,
 8.394170308504492e-04,
 7.761667486385622e-04,
 -7.356510853979224e-05,
 2.365509626662377e-03,
 4.833863215541174e-03,
 -3.730517430357187e-03,
 9.412304825818668e-03,
 -4.046775411498506e-03,
 -4.104273578648126e-03,
 -4.566011308444550e-04,
 -2.905607327427367e-03,
 4.977304711273353e-03,
 -7.591414882259647e-04,
 1.367250011607986e-03,
 1.151500833286039e-03,
 1.577414586063650e-03,
 -1.387420076392479e-03,
 2.952341550407182e-04,
 1.647583512137557e-03,
 -8.671848073304072e-05,
 4.571925754721952e-04,
 -8.841695893772809e-05,
 2.541984617095146e-06,
 -4.174594381603081e-04,
 -4.864100148385627e-09,
 -2.903733800344458e-05,
 -3.387534088067152e-06,
 3.885443494763152e-04,
 1.525598658086156e-04,
 4.423187642382744e-04,
 8.568776524130830e-04,
 4.970506238209413e-04,
 7.843718405359242e-05,
 -5.837063597655656e-04,
 6.501546241768274e-04,
 -1.927578877124940e-03,
 -5.402554244639668e-03,
 -3.705032913039255e-03,
 -9.533715234767284e-03,
 1.850071949348411e-03,
 2.599877009082984e-03,
 1.792176393391097e-03,
 1.507036064267072e-03,
 4.622518953413343e-03,
 -9.689654800796368e-04,
 -1.978046430173802e-04,
 -7.822635039140091e-04,
 -7.494819949099924e-04,
 2.216251083185845e-03,
 -3.706535247040135e-04,
 -1.908072563100349e-04,
 -5.169778496573869e-05,
 -5.677292626475944e-05,
 4.800804202535248e-04,
 2.968934765834764e-06,
 -4.437699245068376e-05,
 4.050815440369104e-09,
 2.865686064377982e-04,
 -6.072382746113591e-04,
 8.965270185547801e-05,
 -3.372236378079094e-04,
 -1.227322574571275e-03,
 -1.120850660361695e-03,
 -5.737675963332089e-04,
 5.047031629129327e-04,
 -1.137229531403985e-03,
 -1.874261539524040e-03,
 1.769983521005698e-03,
 -6.417258155561710e-03,
 2.264173752353080e-03,
 8.390532991448868e-03,
 -1.196277674753545e-03,
 -1.116893615412719e-03,
 -1.744165711870079e-03,
 1.588051785412883e-03,
 3.328397069635382e-03,
 1.945222562480574e-03,
 -2.770996217323491e-04,
 1.733419612364032e-03,
 4.837848952635740e-04,
 1.829992982183422e-03,
 1.441100910404139e-05,
 -2.560852136794100e-04,
 1.395656113136559e-04,
 3.840449671597572e-06,
 -4.142019447698713e-04,
 -4.300102998678425e-09,
 -4.076368259838365e-05,
 -3.279502594779654e-04,
 2.783736285956617e-04,
 -2.580181552071232e-04,
 -7.688480099657594e-05,
 4.469938218954449e-04,
 6.855128926957769e-04,
 6.074139773770320e-04,
 -1.849952474884115e-05,
 5.419660127935657e-04,
 1.320893948917849e-03,
 2.596400058431188e-03,
 1.733647042997110e-03,
 7.560367675278131e-03,
 -2.907014913742513e-04,
 -6.448222792746859e-03,
 2.148944419930892e-03,
 1.423049090676030e-03,
 -1.816976463518129e-03,
 -6.798372022409388e-05,
 2.156127559718851e-03,
 -2.726052125335237e-03,
 -1.830002666543900e-03,
 5.496345988187401e-04,
 -4.521998532461549e-05,
 -9.739455700849970e-04,
 -2.193395247249831e-04,
 -2.231031993205281e-04,
 3.883493715885269e-04,
 1.903962815914128e-06,
 -6.067597547705594e-05,
 5.553615802685800e-09,
 9.330263986485432e-05,
 2.333957990328812e-04,
 1.777590238481915e-04,
 3.424343308438093e-04,
 5.575033549633687e-04,
 2.523380861577162e-04,
 -1.128112481392447e-04,
 -3.426867769818487e-04,
 8.316505110395788e-05,
 8.842911175029779e-05,
 -1.180321434105140e-03,
 3.359790295220892e-03,
 -8.230056376122260e-04,
 -7.756819135394546e-03,
 2.132388380972766e-04,
 4.523551369071158e-03,
 -3.354464657037195e-03,
 1.854739238910903e-04,
 -1.705658450429386e-03,
 -1.738904421085915e-03,
 -2.562465632669265e-03,
 2.107591806410975e-03,
 1.765568865164909e-04,
 2.434763949679326e-04,
 8.034166081281925e-05,
 -8.603546444529922e-04,
 4.085311989061991e-04,
 3.110620176160339e-06,
 -3.246336764111460e-04,
 -7.195274672871281e-09,
 -5.486787365420146e-05,
 2.003530551070315e-04,
 -4.147056462906504e-04,
 7.775724230701578e-05,
 -2.064905308664321e-04,
 -8.170509486987823e-04,
 -7.759094964646952e-04,
 -4.476438789725867e-04,
 2.423597660589791e-04,
 -5.071970955688287e-04,
 -6.061946048606574e-04,
 -7.772330706528572e-04,
 -9.797069586624050e-04,
 -4.432553571673931e-03,
 -8.656571493358762e-04,
 5.687467153871391e-03,
 -3.636908258052552e-03,
 -3.949693582296213e-03,
 -3.912896549438249e-03,
 6.275452835786253e-04,
 1.157000700484016e-03,
 3.316655340861020e-04,
 5.438429100091363e-04,
 -1.870578866670117e-03,
 2.940517284507910e-04,
 -1.222258841230677e-03,
 -2.289160354121182e-04,
 -2.146709229632043e-04,
 1.747833277563179e-04,
 1.397257434319083e-06,
 -7.974261522501928e-05,
 5.727959270199241e-09,
 -3.007579898914769e-04,
 1.411870110163656e-04,
 -2.424063140922299e-04,
 -1.178520158356170e-04,
 2.419341761044729e-04,
 4.652370506086867e-04,
 4.912925154778446e-04,
 9.991653645009460e-05,
 4.104159383110694e-04,
 5.054193957948458e-04,
 7.743812625745865e-04,
 -1.327012121568296e-03,
 4.264293668070454e-04,
 5.081162868154047e-03,
 1.224418009743578e-03,
 -4.500017272660511e-03,
 4.648543680419844e-03,
 -2.409512939839662e-03,
 -2.624957777379400e-03,
 -2.056061080536682e-03,
 -4.267300613639204e-04,
 -1.041728447660443e-03,
 -4.475655352387921e-04,
 -1.715659957138624e-03,
 1.583727814667004e-04,
 -1.029267100744061e-03,
 3.503424335821315e-04,
 9.352470110274585e-07,
 -1.332458240479433e-04,
 -8.482692003108082e-09,
 -7.121723616845160e-05,
 8.848745867630509e-05,
 2.541125746430180e-04,
 1.163133072271201e-04,
 2.470655977258477e-04,
 5.036359616836540e-04,
 3.292533421543768e-04,
 5.486548229739532e-05,
 -2.498473110815369e-04,
 1.502331692516297e-04,
 5.708978827683771e-05,
 -3.920000948785774e-05,
 6.005364401314298e-04,
 1.947156029636712e-03,
 8.043903973882315e-04,
 -2.839877534329383e-03,
 2.514889294434788e-03,
 3.438594649461295e-03,
 4.396741478018273e-03,
 -4.806280116732530e-04,
 -3.253848786187054e-03,
 2.465363551135118e-03,
 1.621081335555317e-03,
 -1.896062016381442e-03,
 2.933405382733060e-04,
 -4.600817619827104e-04,
 -5.275099583450058e-05,
 -3.588101525843398e-05,
 -1.573325101353472e-04,
 -8.043363052636283e-07,
 -1.012670042061504e-04,
 9.313489470343563e-09,
 1.352443856009034e-04,
 -2.365715016765280e-04,
 8.406369346426340e-05,
 -7.328419691828357e-05,
 -4.574768491154754e-04,
 -4.938522954141996e-04,
 -3.461522760238056e-04,
 7.605337320915520e-05,
 -3.451518319807614e-04,
 -3.493092845805364e-04,
 -2.924103473548046e-04,
 2.763922798604655e-04,
 -3.665401584870108e-04,
 -2.458347372732518e-03,
 -1.380870089204622e-03,
 2.285420652165579e-03,
 -2.866830226110136e-03,
 2.383717741021571e-03,
 3.266976389485803e-03,
 3.192727521116784e-03,
 3.224910481682072e-03,
 -1.775858947206222e-03,
 -4.621177234594784e-04,
 -1.591357702546328e-03,
 5.220968132497908e-05,
 -3.317230506383610e-04,
 9.364509086360726e-05,
 -4.053146210205473e-07,
 1.537969637909604e-04,
 -8.309567979220989e-09,
 -8.955357754041798e-05,
 -7.761431218286954e-05,
 -6.922451040312912e-05,
 -7.051143690777130e-05,
 -9.209239000388255e-05,
 -1.310859212834746e-04,
 -5.216646336398728e-05,
 3.818974722224399e-05,
 9.703421557816539e-05,
 -6.669828942014012e-06,
 4.146583793227050e-05,
 8.649122389496279e-05,
 -1.859983559844261e-04,
 -4.541929340012408e-04,
 -2.463740265942590e-04,
 6.638444242360521e-04,
 -7.085950243679032e-04,
 -1.099238059187407e-03,
 -1.431493722334154e-03,
 1.457050100816648e-04,
 1.373133400611360e-03,
 -1.229851585013436e-03,
 -8.929243914469888e-04,
 1.631459820517306e-03,
 -2.621513753069668e-04,
 1.169505554871279e-03,
 2.163029048958731e-04,
 2.079086557584878e-04,
 -5.679528411220954e-04,
 -3.681751944899035e-06,
 -1.248385732205629e-04,
 1.323204139357559e-08,
 -6.864813061468594e-06,
 9.488434934452821e-05,
 2.816971097381590e-06,
 5.531461166532516e-05,
 1.819386591013720e-04,
 1.637662777379842e-04,
 8.680462393638114e-05,
 -5.874703836338399e-05,
 1.030932554777796e-04,
 8.565503565161708e-05,
 3.901364428825364e-05,
 2.997220174419542e-06,
 1.422383559223496e-04,
 6.172881348495894e-04,
 4.873049346307147e-04,
 -5.061679994706613e-04,
 7.621058799668956e-04,
 -7.897740439521408e-04,
 -1.108514050476723e-03,
 -1.173265969596174e-03,
 -1.507157017765543e-03,
 1.070731859443375e-03,
 3.965324221613278e-04,
 1.468554910233463e-03,
 -1.317896330574820e-04,
 1.003693726461224e-03,
 -3.833096923041132e-04,
 -4.695619129855174e-06,
 5.024487200426128e-04,
 -1.410293046452367e-08,
 -1.095507841825913e-04,
 5.390336090231827e-02,
 4.564678474274053e-01,
 -2.377535961834859e-02,
 -1.080442828072696e-02,
 -1.268507558759551e-02,
 -6.518679084764400e-03,
 -2.680171966051986e-03,
 -1.021911452897821e-03,
 -6.260183043240587e-04,
 -5.075923199334779e-04,
 -3.593543841753323e-04,
 2.029957799102977e-04,
 1.152803748745612e-04,
 8.691430858645476e-05,
 2.317011632954137e-04,
 3.416210405928607e-04,
 2.029710546514226e-04,
 -1.636255414059966e-04,
 2.501086176855936e-04,
 -1.324900611843910e-04,
 -4.344921029273364e-05,
 -4.559651317251468e-05,
 9.508822642131081e-06,
 -1.453185648631235e-05,
 -1.359618914414539e-05,
 1.381287053239232e-05,
 2.449143989958935e-05,
 2.800446717485482e-08,
 -1.801550483649811e-08,
 3.191636940039426e-10,
 -1.172786706370659e-10
};


//Legendre polynomial calculation macros and functions

#define calcleg(x) { \
    L[1] = x;\
    for(int i=2;i<nmax;i++) \
	L[i] = 2.*(x)*L[i-1] - L[i-2] - ((x)*L[i-1] - L[i-2])/((double) i); \
}

#define calclegdleg(x) { \
    L[1] = x; \
    for(int i=2;i<nmax;i++) { \
	L[i] = 2.*(x)*L[i-1] - L[i-2] - ((x)*L[i-1] - L[i-2])/((double) i); \
	dL[i] = L[i-1]*i + dL[i-1]*(x); \
    } \
}

#define calcNleg(n,x) { \
    for(int i=2;i<n;i++) \
	L[i] = 2.*(x)*L[i-1] - L[i-2] - ((x)*L[i-1] - L[i-2])/((double) i); \
}

#define calcNlegdleg(n,x) { \
    for(int i=2;i<n;i++) { \
	L[i] = 2.*(x)*L[i-1] - L[i-2] - ((x)*L[i-1] - L[i-2])/((double) i); \
	dL[i] = L[i-1]*i + dL[i-1]*(x); \
    } \
}

#define defL(n) \
    static double L ## n (double x) { \
	double L[n+1]; \
	L[0] = 1.; \
	L[1] = x; \
	calcNleg(n,x); \
	return L[n]; \
    }

#define defLdL(n) \
    static void LdL ## n (double x, double *y, double *z) { \
	double L[n+1]; \
	double dL[n+1]; \
	L[0] = 1.; \
	L[1] = x; \
	dL[0] = 0.; \
	dL[1] = 1.; \
	calcNlegdleg(n,x); \
	*y = L[n]; \
	*z = dL[n]; \
    }


double L0(double x) {return 1.;}
double L1(double x) {return x;}
defL(2)
defL(3)
defL(4)
defL(5)
defL(6)
defL(7)
defL(8)
defL(9)
defL(10)
defL(11)
defL(12)
defL(13)
defL(14)
defL(15)
defL(16)
defL(17)
defL(18)
defL(19)
defL(20)
defL(21)
defL(22)
defL(23)
defL(24)
defL(25)
defL(26)
defL(27)
defL(28)
defL(29)

static double(*Ln[])(double) = {
    L0,
    L1,
    L2,
    L3,
    L4,
    L5,
    L6,
    L7,
    L8,
    L9,
    L10,
    L11,
    L12,
    L13,
    L14,
    L15,
    L16,
    L17,
    L18,
    L19,
    L20,
    L21,
    L22,
    L23,
    L24,
    L25,
    L26,
    L27,
    L28,
    L29
};


static void LdL0(double x, double *y, double *z) {*y=1.; *z=0.;}
static void LdL1(double x, double *y, double *z) {*y=x; *z=1.;}
defLdL(2)
defLdL(3)
defLdL(4)
defLdL(5)
defLdL(6)
defLdL(7)
defLdL(8)
defLdL(9)
defLdL(10)
defLdL(11)
defLdL(12)
defLdL(13)
defLdL(14)
defLdL(15)
defLdL(16)
defLdL(17)
defLdL(18)
defLdL(19)
defLdL(20)
defLdL(21)
defLdL(22)
defLdL(23)
defLdL(24)
defLdL(25)
defLdL(26)
defLdL(27)
defLdL(28)
defLdL(29)

static void(*LdLn[])(double,double *,double *) = {
    LdL0,
    LdL1,
    LdL2,
    LdL3,
    LdL4,
    LdL5,
    LdL6,
    LdL7,
    LdL8,
    LdL9,
    LdL10,
    LdL11,
    LdL12,
    LdL13,
    LdL14,
    LdL15,
    LdL16,
    LdL17,
    LdL18,
    LdL19,
    LdL20,
    LdL21,
    LdL22,
    LdL23,
    LdL24,
    LdL25,
    LdL26,
    LdL27,
    LdL28,
    LdL29
};

// LDA and PBEc coefficients

//pix = 1./(2.*(3.*pi**2)**(1./3.))**2
#define pix 0.026121172985233605
//LDA exchange energy = r2e*rho**4/3
#define r2e (-0.73855876638202245)


#define defaultseed 1

//random number generation macros
#define unirandinc0() \
    ( ((double) random()) / ((double) RAND_MAX) )

#define unirandex0() \
    ( (1.+random()) / (1.+RAND_MAX) )

#define normrand() \
    ( sqrt(-2.*log(unirandex0())) * cos(M_PI*2.*unirandinc0()) )


// beeforder==-1 : calculate beefxc with standard expansion coefficients
// (is changed by beefsetmode_)
static int beeforder = -1;

//arrays holding current Legendre polynomials and derivatives
static double L[nmax] = {1.};
static double dL[nmax] = {0.,1.};

#endif
